---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
---

<BaseLayout title="Deployment" showNav={false}>
  <Header showBack title="Status Deployment" />
  
  <div class="relative flex min-h-screen w-full max-w-md mx-auto flex-col overflow-x-hidden pt-16" id="deployment-container">
    
    <!-- VIEW: LOADING -->
    <div id="loading-view" class="flex-1 flex flex-col items-center pt-8 pb-12 px-6">
      <!-- Headline -->
      <div class="w-full text-center mb-10">
        <h1 class="text-white tracking-tight text-3xl font-bold leading-tight mb-2">Finalisasi Website</h1>
        <p class="text-gray-400 text-sm">Mohon tunggu sebentar, sedang menyiapkan server.</p>
      </div>
      
      <!-- Circular Progress -->
      <div class="relative flex items-center justify-center mb-12">
        <div class="absolute inset-0 bg-primary/20 blur-3xl rounded-full scale-150 animate-pulse-slow"></div>
        <div class="relative size-48">
          <svg class="size-full" viewBox="0 0 100 100">
            <circle class="text-white/10 stroke-current" cx="50" cy="50" fill="transparent" r="42" stroke-width="8"></circle>
            <circle 
              id="progress-circle"
              class="text-primary stroke-current drop-shadow-[0_0_10px_rgba(54,226,123,0.5)]" 
              cx="50" cy="50" fill="transparent" r="42" 
              stroke-dasharray="263.89" 
              stroke-dashoffset="66" 
              stroke-linecap="round" 
              stroke-width="8"
              style="transform: rotate(-90deg); transform-origin: 50% 50%; transition: stroke-dashoffset 0.5s;"
            ></circle>
          </svg>
          <div class="absolute inset-0 flex flex-col items-center justify-center">
            <span id="progress-text" class="text-4xl font-bold text-white tabular-nums tracking-tighter">75<span class="text-2xl text-primary">%</span></span>
            <span class="text-xs font-medium text-primary uppercase tracking-widest mt-1">Processing</span>
          </div>
        </div>
      </div>
      
      <!-- Checklists -->
      <div class="w-full space-y-4 max-w-sm">
        <div class="flex items-center gap-4 p-4 rounded-2xl bg-surface-dark border border-white/5 shadow-sm">
          <div class="flex items-center justify-center size-8 rounded-full bg-primary text-black">
            <span class="material-symbols-outlined text-[20px]">check</span>
          </div>
          <p class="text-base font-medium text-gray-500 line-through">Membuat Repository...</p>
        </div>
        
        <div class="flex items-center gap-4 p-4 rounded-2xl bg-surface-dark border border-white/5 shadow-sm">
          <div class="flex items-center justify-center size-8 rounded-full bg-primary text-black">
            <span class="material-symbols-outlined text-[20px]">check</span>
          </div>
          <p class="text-base font-medium text-gray-500 line-through">Mengupload Foto...</p>
        </div>
        
        <div class="flex items-center gap-4 p-4 rounded-2xl bg-surface-dark border border-primary/30 shadow-[0_0_20px_rgba(54,226,123,0.1)]">
          <div class="flex items-center justify-center size-8 rounded-full bg-white/10 text-primary">
            <span class="material-symbols-outlined text-[20px] animate-spin">progress_activity</span>
          </div>
          <div class="flex flex-col">
            <p class="text-base font-bold text-white">Cloudflare Building...</p>
            <span class="text-xs text-primary mt-1 font-medium">Est. 30s remaining</span>
          </div>
        </div>
      </div>
      
      <div class="mt-auto pt-8 pb-4">
        <p class="text-center text-xs text-white/40">Jangan tutup aplikasi ini saat proses berjalan.</p>
      </div>
    </div>
    
    <!-- VIEW: SUCCESS (hidden initially) -->
    <div id="success-view" class="hidden flex-1 flex-col items-center pt-8 pb-8 px-6 relative overflow-hidden">
      <!-- Confetti Background -->
      <div class="absolute top-0 left-0 w-full h-full pointer-events-none overflow-hidden z-0">
        <div class="absolute top-10 left-[10%] w-3 h-3 bg-primary rounded-full opacity-60 animate-bounce"></div>
        <div class="absolute top-20 right-[20%] w-2 h-4 bg-yellow-400 rotate-45 opacity-70 animate-pulse"></div>
        <div class="absolute top-40 left-[15%] w-4 h-4 bg-blue-500 rounded-sm rotate-12 opacity-50"></div>
        <div class="absolute top-12 left-[50%] w-2 h-2 bg-red-400 rounded-full opacity-80"></div>
        <div class="absolute top-32 right-[10%] w-3 h-3 bg-purple-500 rounded-full opacity-60"></div>
      </div>
      
      <!-- Hero Icon -->
      <div class="relative z-10 mb-6 mt-4">
        <div class="relative size-32 flex items-center justify-center bg-gradient-to-tr from-primary/20 to-transparent rounded-full border border-primary/20">
          <div class="absolute inset-0 bg-primary/20 blur-2xl rounded-full"></div>
          <div class="size-24 rounded-full bg-primary flex items-center justify-center shadow-[0_0_30px_rgba(54,226,123,0.4)]">
            <span class="material-symbols-outlined text-background-dark text-[48px]">rocket_launch</span>
          </div>
          <span class="material-symbols-outlined absolute -top-2 right-0 text-yellow-400 text-2xl animate-bounce">star</span>
          <span class="material-symbols-outlined absolute bottom-0 -left-2 text-blue-400 text-xl animate-pulse">celebration</span>
        </div>
      </div>
      
      <!-- Text Content -->
      <div class="z-10 text-center w-full mb-8">
        <h1 class="text-white tracking-tight text-3xl font-bold leading-tight mb-3">Website Bu Ani<br/>Sudah Online!</h1>
        <p class="text-gray-400 text-base leading-relaxed max-w-[280px] mx-auto">Selamat! Website pisang goreng Bu Ani sekarang bisa diakses oleh pelanggan.</p>
      </div>
      
      <!-- Link Card -->
      <div class="z-10 w-full mb-10">
        <div class="group relative flex items-center justify-between gap-3 p-1 pl-5 pr-1 rounded-full bg-surface-dark border border-white/10 shadow-lg hover:border-primary/50 transition-colors">
          <div class="flex items-center gap-2 overflow-hidden">
            <span class="material-symbols-outlined text-green-500 text-[18px]">lock</span>
            <p class="text-sm font-medium text-white truncate">pisang-bu-ani.quicklaunch.site</p>
          </div>
          <button class="flex items-center justify-center size-10 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors">
            <span class="material-symbols-outlined text-[20px]">content_copy</span>
          </button>
        </div>
        <p class="text-center text-xs text-white/30 mt-3">Link aktif dan aman (SSL)</p>
      </div>
      
      <!-- Actions -->
      <div class="z-10 w-full mt-auto flex flex-col gap-3">
        <button class="btn-primary w-full">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M17.472 14.382C17.112 14.202 15.344 13.332 15.013 13.217C14.682 13.101 14.441 13.044 14.2 13.404C13.96 13.764 13.272 14.57 13.061 14.811C12.851 15.051 12.64 15.082 12.28 14.902C11.92 14.721 10.758 14.341 9.38 13.114C8.283 12.137 7.543 10.931 7.332 10.57C7.122 10.21 7.31 10.016 7.49 9.837C7.653 9.674 7.853 9.412 8.033 9.202C8.213 8.992 8.273 8.841 8.393 8.601C8.514 8.361 8.453 8.15 8.363 7.97C8.273 7.79 7.552 6.017 7.252 5.312C6.96 4.631 6.662 4.722 6.442 4.712C6.241 4.703 6.011 4.703 5.781 4.703C5.551 4.703 5.18 4.793 4.87 5.133C4.559 5.473 3.688 6.291 3.688 7.954C3.688 9.617 4.899 11.224 5.07 11.454C5.24 11.685 7.456 15.105 10.846 16.568C11.652 16.916 12.281 17.124 12.774 17.28C13.593 17.54 14.335 17.502 14.922 17.414C15.578 17.316 16.942 16.588 17.222 15.797C17.503 15.006 17.503 14.325 17.412 14.175C17.322 14.025 17.081 13.935 16.721 13.755H17.472V14.382Z"></path>
          </svg>
          <span>Share ke WhatsApp Bu Ani</span>
        </button>
        
        <button class="w-full rounded-full border border-white/20 bg-transparent p-4 hover:bg-white/5 transition-all active:scale-[0.98]">
          <span class="text-white text-base font-medium">Lihat Website</span>
        </button>
        
        <a href="/" class="text-center text-primary text-sm font-medium mt-2 hover:underline">
          Kembali ke Dashboard
        </a>
      </div>
    </div>
  </div>
  
  <script>
    // Simulate deployment progress
    setTimeout(() => {
      document.getElementById('loading-view')?.classList.add('hidden');
      document.getElementById('success-view')?.classList.remove('hidden');
      document.getElementById('success-view')?.classList.add('flex');
    }, 4000);
  </script>
</BaseLayout>
